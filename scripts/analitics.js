data = {
	fill: 'tozeroy', 
	line: {
		color: 'rgba(55, 128, 191, 1.0)', 
		width: '1.3'
	}, 
	mode: 'lines', 
	type: 'scatter', 
	x: ['2019-01-03', '2019-01-04', '2019-01-08', '2019-01-09', '2019-01-10', '2019-01-11', '2019-01-14', '2019-01-15', '2019-01-16', '2019-01-17', '2019-01-18', '2019-01-21', '2019-01-22', '2019-01-23', '2019-01-24', '2019-01-25', '2019-01-28', '2019-01-29', '2019-01-30', '2019-01-31', '2019-02-01', '2019-02-04', '2019-02-05', '2019-02-06', '2019-02-07', '2019-02-08', '2019-02-11', '2019-02-12', '2019-02-13', '2019-02-14', '2019-02-15', '2019-02-18', '2019-02-19', '2019-02-20', '2019-02-21', '2019-02-22', '2019-02-25', '2019-02-26', '2019-02-27', '2019-02-28', '2019-03-01', '2019-03-04', '2019-03-05', '2019-03-06', '2019-03-07', '2019-03-11', '2019-03-12', '2019-03-13', '2019-03-14', '2019-03-15', '2019-03-18', '2019-03-19', '2019-03-20', '2019-03-21', '2019-03-22', '2019-03-25', '2019-03-26', '2019-03-27', '2019-03-28', '2019-03-29', '2019-04-01', '2019-04-02', '2019-04-03', '2019-04-04', '2019-04-05', '2019-04-08', '2019-04-09', '2019-04-10', '2019-04-11', '2019-04-12', '2019-04-15', '2019-04-16', '2019-04-17', '2019-04-18', '2019-04-19', '2019-04-22', '2019-04-23', '2019-04-24', '2019-04-25', '2019-04-26', '2019-04-29', '2019-04-30', '2019-05-02', '2019-05-03', '2019-05-06', '2019-05-07', '2019-05-08', '2019-05-10', '2019-05-13', '2019-05-14', '2019-05-15', '2019-05-16', '2019-05-17', '2019-05-20', '2019-05-21', '2019-05-22', '2019-05-23', '2019-05-24', '2019-05-27', '2019-05-28', '2019-05-29', '2019-05-30', '2019-05-31', '2019-06-03', '2019-06-04', '2019-06-05', '2019-06-06', '2019-06-07', '2019-06-10', '2019-06-11', '2019-06-13', '2019-06-14', '2019-06-17', '2019-06-18', '2019-06-19', '2019-06-20', '2019-06-21', '2019-06-24', '2019-06-25', '2019-06-26', '2019-06-27', '2019-06-28', '2019-07-01', '2019-07-02', '2019-07-03', '2019-07-04', '2019-07-05', '2019-07-08', '2019-07-09', '2019-07-10', '2019-07-11', '2019-07-12', '2019-07-15', '2019-07-16', '2019-07-17', '2019-07-18', '2019-07-19', '2019-07-22', '2019-07-23', '2019-07-24', '2019-07-25', '2019-07-26', '2019-07-29', '2019-07-30', '2019-07-31', '2019-08-01', '2019-08-02', '2019-08-05', '2019-08-06', '2019-08-07', '2019-08-08', '2019-08-09', '2019-08-12', '2019-08-13', '2019-08-14', '2019-08-15', '2019-08-16', '2019-08-19', '2019-08-20', '2019-08-21', '2019-08-22', '2019-08-23', '2019-08-26', '2019-08-27', '2019-08-28', '2019-08-29', '2019-08-30', '2019-09-02', '2019-09-03', '2019-09-04', '2019-09-05', '2019-09-06', '2019-09-09', '2019-09-10', '2019-09-11', '2019-09-12', '2019-09-13', '2019-09-16', '2019-09-17', '2019-09-18', '2019-09-19', '2019-09-20', '2019-09-23', '2019-09-24', '2019-09-25', '2019-09-26', '2019-09-27', '2019-09-30', '2019-10-01', '2019-10-02', '2019-10-03', '2019-10-04', '2019-10-07', '2019-10-08', '2019-10-09', '2019-10-10', '2019-10-11', '2019-10-14', '2019-10-15', '2019-10-16', '2019-10-17', '2019-10-18', '2019-10-21', '2019-10-22', '2019-10-23', '2019-10-24', '2019-10-25', '2019-10-28', '2019-10-29', '2019-10-30', '2019-10-31', '2019-11-01', '2019-11-05', '2019-11-06', '2019-11-07', '2019-11-08', '2019-11-11', '2019-11-12', '2019-11-13', '2019-11-14', '2019-11-15', '2019-11-18', '2019-11-19', '2019-11-20', '2019-11-21', '2019-11-22', '2019-11-25', '2019-11-26', '2019-11-27', '2019-11-28', '2019-11-29', '2019-12-02', '2019-12-03', '2019-12-04', '2019-12-05', '2019-12-06', '2019-12-09', '2019-12-10', '2019-12-11', '2019-12-12', '2019-12-13', '2019-12-16', '2019-12-17', '2019-12-18', '2019-12-19', '2019-12-20', '2019-12-23', '2019-12-24', '2019-12-25', '2019-12-26', '2019-12-27', '2019-12-30', '2020-01-03', '2020-01-06', '2020-01-08', '2020-01-09', '2020-01-10', '2020-01-13', '2020-01-14', '2020-01-15', '2020-01-16', '2020-01-17', '2020-01-20', '2020-01-21', '2020-01-22', '2020-01-23', '2020-01-24', '2020-01-27', '2020-01-28', '2020-01-29', '2020-01-30', '2020-01-31', '2020-02-03', '2020-02-04', '2020-02-05', '2020-02-06', '2020-02-07', '2020-02-10', '2020-02-11', '2020-02-12', '2020-02-13', '2020-02-14', '2020-02-17', '2020-02-18', '2020-02-19', '2020-02-20', '2020-02-21', '2020-02-25', '2020-02-26', '2020-02-27', '2020-02-28', '2020-03-02', '2020-03-03', '2020-03-04', '2020-03-05', '2020-03-06', '2020-03-10', '2020-03-11', '2020-03-12', '2020-03-13', '2020-03-16', '2020-03-17', '2020-03-18', '2020-03-19', '2020-03-20', '2020-03-23', '2020-03-24', '2020-03-25', '2020-03-26', '2020-03-27', '2020-03-30', '2020-03-31', '2020-04-01', '2020-04-02', '2020-04-03', '2020-04-06', '2020-04-07', '2020-04-08', '2020-04-09', '2020-04-10', '2020-04-13', '2020-04-14', '2020-04-15', '2020-04-16', '2020-04-17', '2020-04-20', '2020-04-21', '2020-04-22', '2020-04-23', '2020-04-24', '2020-04-27', '2020-04-28', '2020-04-29', '2020-04-30', '2020-05-04', '2020-05-05', '2020-05-06', '2020-05-07', '2020-05-08', '2020-05-12', '2020-05-13', '2020-05-14', '2020-05-15', '2020-05-18', '2020-05-19', '2020-05-20', '2020-05-21', '2020-05-22', '2020-05-25', '2020-05-26', '2020-05-27', '2020-05-28', '2020-05-29', '2020-06-01', '2020-06-02', '2020-06-03', '2020-06-04', '2020-06-05', '2020-06-08', '2020-06-09', '2020-06-10', '2020-06-11', '2020-06-15', '2020-06-16', '2020-06-17', '2020-06-18', '2020-06-19', '2020-06-22', '2020-06-23', '2020-06-25', '2020-06-26', '2020-06-29', '2020-06-30', '2020-07-02', '2020-07-03', '2020-07-06', '2020-07-07', '2020-07-08', '2020-07-09', '2020-07-10', '2020-07-13', '2020-07-14', '2020-07-15', '2020-07-16', '2020-07-17', '2020-07-20', '2020-07-21', '2020-07-22', '2020-07-23', '2020-07-24', '2020-07-27', '2020-07-28', '2020-07-29', '2020-07-30', '2020-07-31', '2020-08-03', '2020-08-04', '2020-08-05', '2020-08-06', '2020-08-07', '2020-08-10', '2020-08-11', '2020-08-12', '2020-08-13', '2020-08-14', '2020-08-17', '2020-08-18', '2020-08-19', '2020-08-20', '2020-08-21', '2020-08-24', '2020-08-25', '2020-08-26', '2020-08-27', '2020-08-28', '2020-08-31', '2020-09-01', '2020-09-02', '2020-09-03', '2020-09-04', '2020-09-07', '2020-09-08', '2020-09-09', '2020-09-10', '2020-09-11', '2020-09-14', '2020-09-15', '2020-09-16', '2020-09-17', '2020-09-18', '2020-09-21', '2020-09-22', '2020-09-23', '2020-09-24', '2020-09-25', '2020-09-28', '2020-09-29', '2020-09-30', '2020-10-01', '2020-10-02', '2020-10-05', '2020-10-06', '2020-10-07', '2020-10-08', '2020-10-09', '2020-10-12', '2020-10-13', '2020-10-14', '2020-10-15', '2020-10-16', '2020-10-19', '2020-10-20', '2020-10-21', '2020-10-22', '2020-10-23', '2020-10-26', '2020-10-27', '2020-10-28', '2020-10-29', '2020-10-30', '2020-11-02', '2020-11-03', '2020-11-05', '2020-11-06', '2020-11-09', '2020-11-10', '2020-11-11', '2020-11-12', '2020-11-13', '2020-11-16', '2020-11-17', '2020-11-18', '2020-11-19', '2020-11-20', '2020-11-23', '2020-11-24', '2020-11-25', '2020-11-26', '2020-11-27', '2020-11-30', '2020-12-01', '2020-12-02', '2020-12-03', '2020-12-04', '2020-12-07', '2020-12-08', '2020-12-09', '2020-12-10', '2020-12-11', '2020-12-14', '2020-12-15', '2020-12-16', '2020-12-17', '2020-12-18', '2020-12-21', '2020-12-22', '2020-12-23', '2020-12-24', '2020-12-25', '2020-12-28', '2020-12-29', '2020-12-30', '2021-01-04', '2021-01-05', '2021-01-06', '2021-01-08', '2021-01-11', '2021-01-12', '2021-01-13', '2021-01-14', '2021-01-15', '2021-01-18', '2021-01-19', '2021-01-20', '2021-01-21', '2021-01-22', '2021-01-25', '2021-01-26', '2021-01-27', '2021-01-28', '2021-01-29', '2021-02-01', '2021-02-02', '2021-02-03', '2021-02-04', '2021-02-05', '2021-02-08', '2021-02-09', '2021-02-10', '2021-02-11', '2021-02-12', '2021-02-15', '2021-02-16', '2021-02-17', '2021-02-18', '2021-02-19', '2021-02-20', '2021-02-22', '2021-02-24', '2021-02-25', '2021-02-26', '2021-03-01', '2021-03-02', '2021-03-03', '2021-03-04', '2021-03-05', '2021-03-09', '2021-03-10', '2021-03-11', '2021-03-12', '2021-03-15', '2021-03-16', '2021-03-17', '2021-03-18', '2021-03-19', '2021-03-22', '2021-03-23', '2021-03-24', '2021-03-25', '2021-03-26', '2021-03-29', '2021-03-30', '2021-03-31', '2021-04-01', '2021-04-02', '2021-04-05', '2021-04-06', '2021-04-07', '2021-04-08', '2021-04-09', '2021-04-12', '2021-04-13', '2021-04-14', '2021-04-15', '2021-04-16', '2021-04-19', '2021-04-20', '2021-04-21', '2021-04-22', '2021-04-23', '2021-04-26', '2021-04-27', '2021-04-28', '2021-04-29', '2021-04-30', '2021-05-04', '2021-05-05', '2021-05-06', '2021-05-07', '2021-05-10', '2021-05-11', '2021-05-12', '2021-05-13', '2021-05-14', '2021-05-17', '2021-05-18', '2021-05-19', '2021-05-20', '2021-05-21', '2021-05-24', '2021-05-25', '2021-05-26', '2021-05-27', '2021-05-28', '2021-05-31', '2021-06-01', '2021-06-02', '2021-06-03', '2021-06-04', '2021-06-07', '2021-06-08', '2021-06-09', '2021-06-10', '2021-06-11', '2021-06-14', '2021-06-15', '2021-06-16', '2021-06-17', '2021-06-18', '2021-06-21', '2021-06-22', '2021-06-23', '2021-06-24', '2021-06-25', '2021-06-28', '2021-06-29', '2021-06-30', '2021-07-01', '2021-07-02', '2021-07-05', '2021-07-06', '2021-07-07', '2021-07-08', '2021-07-09'], 
	y: [1859.5, 1916.0, 1926.5, 1960.0, 1985.0, 1983.0, 1992.5, 1999.5, 1980.0, 1993.5, 2044.5, 2044.5, 2051.0, 2060.0, 2083.0, 2152.0, 2167.0, 2152.0, 2157.0, 2212.0, 2197.2, 2212.0, 2250.8, 2244.0, 2192.2, 2163.4, 2196.0, 2230.0, 2258.0, 2264.0, 2200.2, 2161.0, 2126.6, 2166.2, 2115.0, 2133.0, 2214.6, 2169.6, 2163.0, 2208.0, 2247.4, 2303.6, 2340.2, 2362.0, 2329.2, 2346.4, 2355.0, 2345.0, 2303.4, 2352.8, 2306.0, 2318.8, 2301.4, 2274.0, 2276.4, 2293.8, 2315.8, 2268.0, 2317.8, 2293.6, 2243.4, 2249.0, 2268.2, 2280.8, 2298.0, 2301.6, 2346.0, 2350.8, 2434.0, 2435.2, 2453.0, 2499.8, 2451.0, 2383.2, 2415.2, 2400.0, 2412.8, 2410.6, 2407.6, 2389.0, 2406.0, 2391.0, 2413.0, 2414.0, 2407.0, 2388.6, 2379.0, 2340.0, 2286.6, 2299.0, 2312.0, 2392.0, 2425.0, 2407.8, 2392.4, 2424.8, 2365.0, 2383.4, 2404.6, 2280.2, 2350.2, 2379.6, 2336.6, 2319.0, 2341.0, 2361.0, 2389.0, 2418.6, 2435.0, 2494.8, 2492.0, 2465.0, 2455.8, 2480.2, 2470.2, 2492.8, 2468.4, 2452.6, 2424.6, 2391.6, 2410.0, 2405.4, 2482.4, 2491.2, 2505.4, 2494.8, 2481.4, 2465.0, 2478.0, 2500.2, 2495.0, 2573.0, 2546.4, 2542.6, 2509.2, 2489.8, 2518.0, 2486.0, 2482.8, 2507.0, 2461.6, 2520.0, 2441.0, 2480.4, 2490.0, 2550.6, 2470.0, 2369.6, 2413.0, 2428.8, 2413.2, 2405.0, 2410.0, 2428.0, 2374.0, 2365.4, 2394.0, 2424.0, 2438.4, 2421.2, 2399.0, 2391.0, 2394.4, 2429.8, 2434.0, 2441.0, 2462.8, 2469.8, 2487.0, 2487.0, 2509.2, 2503.6, 2466.0, 2450.2, 2466.2, 2457.0, 2453.0, 2447.6, 2438.4, 2432.0, 2407.4, 2350.2, 2342.2, 2301.4, 2322.4, 2319.6, 2315.8, 2263.4, 2287.0, 2250.0, 2265.0, 2274.4, 2284.2, 2295.2, 2312.0, 2327.0, 1898.0, 1975.6, 1986.6, 1957.2, 1927.0, 1934.0, 2061.0, 2054.6, 2046.6, 2090.2, 2064.0, 2118.4, 2134.4, 2156.0, 2125.8, 2138.0, 2171.4, 2191.0, 2187.8, 2184.8, 2179.6, 2184.0, 2173.8, 2186.4, 2267.0, 2525.2, 2510.0, 2514.4, 2549.0, 2566.2, 2629.0, 2635.8, 2668.0, 2624.6, 2693.0, 2620.6, 2599.0, 2607.4, 2568.4, 2570.4, 2584.0, 2588.0, 2595.0, 2628.0, 2662.8, 2690.0, 2660.0, 2625.0, 2623.2, 2680.0, 2699.8, 2688.0, 2687.0, 2713.0, 2736.0, 2697.0, 2685.0, 2672.0, 2677.0, 2728.4, 2725.0, 2703.4, 2685.0, 2690.0, 2719.8, 2772.8, 2800.0, 2770.0, 2790.0, 2820.2, 2798.0, 2780.0, 2799.8, 2890.0, 2888.0, 2873.4, 2880.6, 2990.0, 3008.2, 3048.2, 3103.8, 3087.2, 3085.0, 3037.2, 3087.4, 3011.0, 2983.6, 2937.0, 2953.0, 2988.4, 2911.8, 2681.8, 2690.8, 2678.2, 2659.8, 2721.4, 2723.0, 2654.2, 2728.2, 2685.0, 2590.0, 2615.0, 2460.0, 2470.0, 2370.0, 2425.0, 2318.8, 2434.0, 2455.2, 2299.8, 2459.0, 2555.8, 2610.0, 2597.0, 2670.2, 2714.4, 2605.8, 2550.8, 2520.0, 2582.0, 2668.0, 2742.6, 2697.2, 2701.0, 2659.0, 2755.6, 2588.2, 2637.8, 2630.4, 2736.4, 2659.2, 2655.0, 2640.6, 2621.0, 2715.0, 2754.8, 2870.0, 2850.8, 2828.8, 2842.2, 2864.0, 2910.2, 2975.2, 2977.0, 2893.4, 2821.8, 2839.6, 2945.0, 2970.0, 2964.6, 2910.8, 2905.0, 2960.6, 2913.2, 2826.0, 2888.0, 2833.2, 2846.0, 2837.8, 2867.6, 2861.6, 2884.0, 2873.2, 2902.0, 2881.2, 2850.0, 2967.4, 3009.0, 3068.2, 3108.0, 3155.0, 3254.2, 3358.6, 3499.0, 3430.0, 3467.0, 3545.6, 3548.6, 3549.6, 3639.0, 3598.8, 3581.8, 3637.8, 3633.0, 3678.0, 3772.0, 3882.8, 3824.0, 3950.0, 4029.0, 3964.0, 4010.0, 4002.8, 4017.2, 4123.0, 4114.4, 4187.8, 4191.0, 4257.0, 4288.6, 4312.0, 4340.2, 4413.8, 4360.0, 4205.0, 4185.8, 4288.8, 4366.0, 4389.6, 4500.0, 4503.0, 4620.0, 4700.0, 4772.0, 4913.4, 5055.0, 4973.6, 4842.8, 4845.0, 5089.4, 5033.0, 5070.0, 4917.8, 4885.0, 4975.0, 4670.2, 4743.4, 4597.8, 4662.0, 4730.0, 4685.8, 4637.0, 4595.0, 4628.0, 4527.8, 4900.0, 5008.6, 4775.0, 4934.0, 5080.0, 5095.0, 5062.0, 4928.8, 4907.0, 4980.0, 4869.0, 4779.4, 4714.6, 4683.0, 4759.8, 4838.8, 4772.0, 4754.4, 4530.0, 4457.0, 4340.0, 4410.2, 4455.0, 4523.2, 4504.0, 4600.8, 4586.0, 4637.2, 4561.0, 4589.2, 4591.0, 4854.8, 4927.0, 4985.4, 4696.0, 4724.8, 4718.8, 4799.0, 4735.2, 4680.0, 4691.2, 4742.6, 4745.6, 4687.6, 4935.8, 4946.0, 4985.2, 5115.0, 5278.0, 5310.4, 5193.6, 5166.0, 5065.2, 5002.2, 5066.4, 5094.0, 5169.2, 5124.0, 5040.0, 5050.0, 5198.0, 5145.4, 5082.0, 5004.4, 5084.0, 5113.0, 5029.0, 5039.8, 5026.4, 5020.4, 5167.0, 5185.2, 5340.4, 5188.8, 5254.2, 5214.2, 5121.8, 5079.8, 5077.4, 4998.0, 5043.6, 5008.8, 5170.0, 5069.0, 5015.8, 4901.8, 4898.2, 4828.4, 4876.2, 4760.6, 4847.4, 4997.0, 4917.2, 5016.6, 4973.6, 5060.4, 5147.2, 5306.0, 5361.6, 5448.0, 5478.0, 5348.0, 5187.0, 5007.8, 5005.0, 5064.0, 4918.0, 4928.2, 4857.4, 4813.2, 5004.6, 5027.0, 4890.2, 4718.2, 4722.8, 4707.6, 4692.0, 4889.8, 4960.4, 5039.0, 5161.8, 5037.6, 4858.0, 4880.0, 4891.0, 4906.0, 4850.0, 4741.0, 4785.0, 4830.0, 4788.0, 4859.0, 4949.2, 4935.0, 4940.0, 4961.8, 4845.2, 4888.0, 4813.0, 4854.8, 4600.0, 4661.0, 4677.8, 4690.0, 4663.8, 4665.6, 4648.0, 4605.0, 4570.2, 4703.6, 4732.0, 4834.8, 5040.0, 4934.8, 4802.2, 4864.4, 4828.6, 4831.6, 4702.8, 4678.0, 4601.0, 4638.4, 4687.0, 4704.2, 4740.0, 4741.6, 4750.8, 4767.2, 4891.8, 4897.8, 4995.4, 4962.2, 4945.0, 4942.0, 4933.0, 4948.0, 4901.8, 4923.4, 4911.4, 4889.6, 4973.0, 5005.8, 5056.8, 5090.0, 4925.0, 4962.8, 5041.4, 5047.0, 5008.4, 5007.0, 5040.0, 5033.0, 5088.0, 5099.8, 5084.6, 5176.6, 5168.6, 5216.0, 5212.4, 5247.4, 5341.4, 5354.2, 5235.8],  
	fillcolor: 'rgba(17, 203, 91, 0.05)'
};

layout = {	
	xaxis: {
		showgrid: false,
		fixedrange: true,
		tickfont: {
			color: '#6c757d'
		}

	},
	yaxis: {
		fixedrange: true,
		tickfont: {
			color: '#6c757d'
		}

	},
	margin: {
		l: 40,
		r: 40,
		b: 40,
		t: 40
	}, 
	title: false
};

config = {
	displayModeBar: false, 
	responsive: true
};


async function renderSecsPlot() {
	response = await fetch('http://127.0.0.1:5000/stock/' + secid);

	result = await response.json();
	
	data['x'] = result['date']
	data['y'] = result['close']

	layout.yaxis.range = [Math.min(...data.y), Math.max(...data.y)]

	Plotly.newPlot('plot', [data], layout, config);
}

function declOfNum(number, titles) {  
    
    cases = [2, 0, 1, 1, 1, 2];  
    
    return titles[(number%100>4 && number%100<20)? 2 : cases[(number%10<5)?number%10:5]];  
}

function renderSentBook(data) {

	bos_pos = data.bos_positive
	bos_neg = data.bos_negative

	per_pos = Math.round(bos_pos / (bos_pos + Math.abs(bos_neg)) * 100);

	template = _.template(document.getElementById('template-sent').innerHTML);	
			
	item = template({
		per_pos: per_pos,
		per_neg: 100 - per_pos,
		num_pos: `${data.num_positive} ${declOfNum(data.num_positive, ['новость', 'новости', 'новостей'])}`,
		num_neg: `${data.num_negative} ${declOfNum(data.num_negative, ['новость', 'новости', 'новостей'])}`,
	});

	document.getElementById('sent').innerHTML = item;

	calendar = document.getElementById('date');
	calendar.valueAsDate = new Date(date);
	calendar.max = new Date();
}

function renderNewsList(data) {

	document.getElementById('news').innerHTML = ''

	data.forEach(async function(news) {
		
		response = await fetch(`https://buyorsell.ml/api/db/news?id=${news[0].id}&secid=${secid}`);

		result = await response.json();
		
		template = _.template(document.getElementById('template-news').innerHTML);

		news[0].bos = (result.bos * 100).toFixed(1)


		var options = {
			year: 'numeric',
			month: 'numeric',
			day: 'numeric',
			hour: 'numeric',
			minute: 'numeric',
			timezone: 'UTC'
		};

		news[0].datetime = new Date(news[0].datetime).toLocaleString("ru", options)

		document.getElementById('news').innerHTML += template(news[0]);

		}
	);
}

function renderSecsList(data) {

	data.forEach(function(ticker) {

			template = _.template(document.getElementById('template-sec').innerHTML);	
			
			ticker.bos = (ticker.bos * 100).toFixed(1);
			
			item = template(ticker);

			document.getElementById('secs').innerHTML += item;
		}
	);
}

async function loadAnalitics() {

	response = await fetch(`https://buyorsell.ml/api/db/news?secid=${secid}&date=${week}`);

	result = await response.json();
	
	renderSentBook(result.sent);
	renderNewsList(result.news);
}

async function loadSecList()
{
	response = await fetch('https://buyorsell.ml/api/db/stock');

	result = await response.json();
	
	renderSecsList(result);
}

async function loadSecPlot() {

	response = await fetch(`https://buyorsell.ml/stock/${secid}.html`);

	result = await response.text();

	parser = new DOMParser();
	
	doc = parser.parseFromString(result, "text/html");
	
	//alert(doc.getElementsByTagName('body')[0].innerHTML)
	//document.getElementById('plot').innerHTML += 'abc'
	document.getElementById('plot').innerHTML += doc.getElementsByTagName('body')[0].innerHTML;

}

function onSecsChange(secid2) {

	date = document.getElementById('date');
	date.valueAsDate = new Date();
	date = date.value.replace(".", "-")

	secid = secid2;

	renderSecsPlot();

	loadAnalitics();
}

function onDateChange(date1) {

	date = date1.replace(".", "-")

	loadAnalitics();

}


function onWeekChange(date1) {

	year = date1.split("-W")[0]
	week = date1.split("-W")[1]

	d = new Date(year, 0, 1);
	d.setDate(d.getDate() + (week * 7));
	
	week = Math.round((d.getTime() / 1000) / (60*60*24*7))

	loadAnalitics();
}

function onBodyLoad()
{
	secid = window.location.href.split("?")[1].split("=")[1];

	//date = '2011-06-17'
	week = '2690';

	loadAnalitics();
	loadSecList();
	//loadSecPlot();
	//renderSecsPlot();


	//date = document.getElementById('date');
	//date.valueAsDate = new Date();
	//date.max = date.value

	//date = date.value.replace(".", "-")
}